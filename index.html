<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>R3vival â€” Shop</title>

<!-- Lemon Squeezy embed (checkout modal) -->
<script src="https://app.lemonsqueezy.com/js/checkout.js" async></script>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  /* Your existing CSS stays unchanged */
  *{box-sizing:border-box}
  body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto, "Helvetica Neue", Arial; margin:0; background:#ffffff; color:#111; -webkit-font-smoothing:antialiased}
  a{color:inherit}
  header{background:#fff;border-bottom:1px solid #eef0f3;padding:20px 16px;position:sticky;top:0;z-index:60}
  .nav-wrap{display:flex;align-items:center;gap:18px;width:100%;max-width:1100px;margin:0 auto;justify-content:space-between}
  .nav-left,.nav-right{display:flex;gap:12px;align-items:center;flex:1;justify-content:center}
  .logo-block{flex:0 0 auto;display:flex;align-items:center;justify-content:center;margin:0 12px}
  .logo { height:72px; width:auto; border-radius:8px; transition:transform .35s; }
  nav a{font-weight:700;padding:8px 12px;border-radius:8px;text-decoration:none;color:#222;transition:all .15s;cursor:pointer}
  nav a.active{background:#f3f8ff;color:#0366d6;box-shadow:0 6px 14px rgba(3,102,214,0.06)}
  nav a:hover{transform:translateY(-2px);color:#0366d6}
  main{max-width:1200px;margin:28px auto;padding:0 16px;display:flex;flex-direction:column;gap:20px}
  .shop-head{display:flex;align-items:center;justify-content:space-between;gap:12px}
  .shop-head h1{font-size:20px;margin:0;color:#111}
  #productsGrid{display:flex;flex-wrap:wrap;gap:20px;justify-content:flex-start}
  .product-card{width:260px;background:#fff;border-radius:12px;padding:14px;box-shadow:0 8px 20px rgba(12,18,30,0.04);display:flex;flex-direction:column;align-items:center;transition:transform .16s,box-shadow .16s;position:relative}
  .product-card:hover{transform:translateY(-6px);box-shadow:0 16px 36px rgba(12,18,30,0.07)}
  .product-img{width:100%;height:240px;border-radius:10px;object-fit:cover;margin-bottom:12px;background:#f7f9fb}
  .product-title{font-weight:700;text-align:center;font-size:15px;margin:6px 0;color:#111}
  .product-desc{font-size:13px;color:#5b6270;text-align:center;margin-top:6px;min-height:34px}
  .price{color:#0366d6;font-weight:800;margin-top:8px;font-size:1.05rem}
  .product-actions{display:flex;gap:10px;margin-top:12px;width:100%}
  .size-select{flex:1;padding:9px;border-radius:10px;border:1px solid #eef2f6;background:#fff}
  .add-btn{flex:1;padding:10px;border-radius:10px;border:none;background:#0366d6;color:#fff;font-weight:700;cursor:pointer}
  .add-btn:hover{background:#024ea8;transform:translateY(-1px)}
  .badge-pre{position:absolute;right:12px;top:12px;background:#ff9f1c;color:white;padding:6px 8px;border-radius:8px;font-weight:700;font-size:12px}
  .cart-button{position:fixed;right:22px;bottom:22px;width:62px;height:62px;border-radius:50%;background:linear-gradient(180deg,#0366d6,#024ea8);color:#fff;display:flex;align-items:center;justify-content:center;box-shadow:0 18px 40px rgba(3,102,214,0.18);cursor:pointer;z-index:999;font-size:20px}
  .cart-count{position:fixed;right:16px;bottom:88px;background:#ff3b30;color:#fff;font-weight:800;padding:6px 9px;border-radius:999px;z-index:999;font-size:13px;box-shadow:0 8px 20px rgba(0,0,0,0.12);display:none}
  .cart-drawer{position:fixed;right:0;top:0;height:100vh;width:420px;background:#fff;box-shadow:-20px 0 60px rgba(10,20,40,0.12);transform:translateX(110%);transition:transform .28s ease;z-index:1000;display:flex;flex-direction:column;padding:18px}
  .cart-drawer.open{transform:translateX(0)}
  .cart-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
  .cart-items{flex:1;overflow:auto;padding-right:6px;margin-top:6px}
  .cart-item{display:flex;gap:12px;align-items:center;padding:10px 0;border-bottom:1px solid #f0f4f8}
  .cart-item img{width:72px;height:72px;border-radius:10px;object-fit:cover}
  .cart-item-info{flex:1}
  .cart-item-title{font-weight:700}
  .cart-item-price{color:#0366d6;margin-top:6px;font-weight:700}
  .cart-controls{display:flex;align-items:center;gap:10px;margin-top:8px}
  .qty-btn{padding:6px 10px;border-radius:8px;border:none;background:#eef6ff;color:#0366d6;cursor:pointer}
  .remove-btn{background:transparent;border:none;color:#ff3b30;cursor:pointer}
  .cart-footer{padding-top:12px;border-top:1px solid #f0f4f8}
  .total-row{display:flex;justify-content:space-between;font-weight:800;margin-bottom:12px;font-size:1.05rem}
  .checkout-btn{width:100%;padding:12px;border-radius:10px;border:none;background:#0366d6;color:#fff;font-weight:800;cursor:pointer}
  .checkout-btn:disabled{opacity:.6;cursor:not-allowed}
  .info-row{display:flex;gap:18px;margin-top:20px;flex-wrap:wrap}
  .info-card{flex:1;min-width:260px;background:#fff;border-radius:12px;padding:18px;box-shadow:0 12px 30px rgba(8,12,20,0.04)}
  .fade-in-up{animation:fadeUp .45s ease both}
  @keyframes fadeUp{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
  @media(max-width:920px){ .cart-drawer{width:100%} #productsGrid{justify-content:center} .nav-left,.nav-right{display:none} .logo-block{margin:0} }
</style>
</head>
<body>

<header>
  <div class="nav-wrap">
    <div class="nav-left">
      <nav><a onclick="showPage('products')" id="nav-products">Products</a><a onclick="showPage('about')" id="nav-about">About</a></nav>
    </div>

    <div class="logo-block">
      <img class="logo" src="https://i.postimg.cc/nr1DTD7V/r3vival.jpg" alt="R3vival">
    </div>

    <div class="nav-right">
      <nav><a onclick="showPage('contact')" id="nav-contact">Contact</a></nav>
    </div>
  </div>
</header>

<main>
  <div class="shop-head">
    <h1>R3vival â€” Faith. Style. Revival.</h1>
    <div style="color:#666;font-size:14px">Free shipping over $75</div>
  </div>

  <section id="productsSection" class="fade-in-up">
    <div id="productsGrid" aria-live="polite"></div>
  </section>

  <section id="aboutSection" style="display:none">
    <div class="info-card fade-in-up" style="max-width:920px;margin:0 auto">
      <h2>About Project R3vival</h2>
      <p>Project R3vival is a religious clothing brand combining both faith and style...</p>
    </div>
  </section>

  <section id="contactSection" style="display:none">
    <div class="info-row">
      <div class="info-card">
        <h3>About Us</h3>
        <p>Shop Now</p>
        <p>Long Island,</p>
        <p>New York, NY</p>
      </div>
      <div class="info-card">
        <h3>Working Hours</h3>
        <p>Mon - Fri: 1pm - 9pm</p>
        <p>Saturday: All Hours</p>
        <p>Sunday: All Hours</p>
      </div>
      <div class="info-card">
        <h3>Customer Support</h3>
        <p>Tel: 1-800-123-4567</p>
        <p>Email: <a href="mailto:R3vivalapparel@gmail.com">R3vivalapparel@gmail.com</a></p>
      </div>
    </div>
  </section>
</main>

<div class="cart-button" id="cartButton" title="Open cart">ðŸ›’</div>
<div class="cart-count" id="cartCount">0</div>

<div class="cart-drawer" id="cartDrawer" aria-hidden="true">
  <div class="cart-header">
    <h3>Your Cart</h3>
    <button onclick="closeCart()" aria-label="Close">âœ•</button>
  </div>

  <div class="cart-items" id="cartItems"></div>

  <div class="cart-footer">
    <div class="total-row"><span>Total</span><span id="cartTotal">$0.00</span></div>
    <button class="checkout-btn" id="checkoutBtn" onclick="checkout()" disabled>Checkout</button>
  </div>
</div>

<script>
/* -------------- PRODUCTS -------------- */
const PRODUCTS = [
  { id:'p1', name:'â€œBlossom Treeâ€ Heavyweight T-Shirt', variantId:'12345', price:30.00, image:'https://imagedelivery.net/HL_Fwm__tlvUGLZF2p74xw/b2438af1-b6c0-4a64-d236-ca0cec099800/public', preorder:false },
  { id:'p2', name:'â€œThe Searchâ€ Hoodie', variantId:'12346', price:49.99, image:'https://imagedelivery.net/HL_Fwm__tlvUGLZF2p74xw/7e5751eb-432a-4391-6fe1-112588414500/public', preorder:false }
];

/* -------------- STATE -------------- */
let cart = []; // { id, variantId, name, price, img, qty }

/* -------------- HELPERS -------------- */
function formatPrice(n){ return '$' + Number(n || 0).toFixed(2); }
function el(tag, attrs={}, children=[]){ const e=document.createElement(tag); for(const k in attrs) if(k==='html') e.innerHTML=attrs[k]; else e.setAttribute(k, attrs[k]); (Array.isArray(children)?children:[children]).forEach(c=>{ if(typeof c==='string') e.appendChild(document.createTextNode(c)); else if(c) e.appendChild(c)}); return e; }

/* -------------- RENDER PRODUCTS -------------- */
function renderProducts(){
  const grid = document.getElementById('productsGrid');
  grid.innerHTML = '';
  PRODUCTS.forEach(p=>{
    const card = el('div',{class:'product-card fade-in-up', style:'position:relative;'});
    if (p.preorder) card.appendChild(el('div',{class:'badge-pre'}, ['PREORDER']));
    const img = el('img',{class:'product-img', src:p.image, alt:p.name});
    const title = el('div',{class:'product-title'}, [p.name]);
    const price = el('div',{class:'price'}, [formatPrice(p.price)]);
    const actions = el('div',{class:'product-actions'});
    const addBtn = el('button',{class:'add-btn'}, [p.preorder?'Preorder':'Add to cart']);
    addBtn.onclick = ()=> addToCart({
      id: p.id,
      variantId: p.variantId,
      name: p.name,
      price: p.price,
      img: p.image
    });
    actions.appendChild(addBtn);
    card.appendChild(img); card.appendChild(title); card.appendChild(price); card.appendChild(actions);
    grid.appendChild(card);
  });
}

/* -------------- CART -------------- */
function addToCart(item){
  const found = cart.find(i => i.variantId === item.variantId);
  if (found) found.qty++; else cart.push({...item, qty:1});
  renderCart(); openCart();
}

function renderCart(){
  const container = document.getElementById('cartItems');
  container.innerHTML = '';
  let total = 0;
  cart.forEach((it, idx)=>{
    const row = el('div',{class:'cart-item'});
    const img = el('img',{src: it.img, alt: it.name});
    const info = el('div',{class:'cart-item-info'});
    info.innerHTML = `<div class="cart-item-title">${it.name}</div><div class="cart-item-price">${formatPrice(it.price)}</div>`;
    const controls = el('div',{class:'cart-controls'});
    const minus = el('button',{class:'qty-btn'}, ['âˆ’']); minus.onclick = ()=>{ if(it.qty>1) it.qty--; else removeFromCart(idx); renderCart(); };
    const qty = el('div',{}, [String(it.qty)]);
    const plus = el('button',{class:'qty-btn'}, ['+']); plus.onclick = ()=>{ it.qty++; renderCart(); };
    const remove = el('button',{class:'remove-btn'}, ['Remove']); remove.onclick = ()=>{ removeFromCart(idx); };
    controls.appendChild(minus); controls.appendChild(qty); controls.appendChild(plus); controls.appendChild(remove);
    row.appendChild(img); row.appendChild(info); row.appendChild(controls);
    container.appendChild(row);
    total += it.price*it.qty;
  });
  document.getElementById('cartTotal').textContent = formatPrice(total);
  const cc = document.getElementById('cartCount');
  cc.textContent = cart.reduce((s,i)=>s+i.qty,0);
  cc.style.display = cart.length?'block':'none';
  document.getElementById('checkoutBtn').disabled = cart.length === 0;
}

function removeFromCart(idx){ cart.splice(idx,1); renderCart(); }

const drawer = document.getElementById('cartDrawer');
function openCart(){ drawer.classList.add('open'); drawer.setAttribute('aria-hidden','false'); renderCart(); }
function closeCart(){ drawer.classList.remove('open'); drawer.setAttribute('aria-hidden','true'); }

/* -------------- CHECKOUT -------------- */
async function checkout(){
  if(cart.length===0) return alert("Cart is empty");
  try {
    // send cart to server to create LS checkout session
    const res = await fetch("/api/create-checkout", {
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body: JSON.stringify({items: cart.map(i=>({variant:i.variantId,quantity:i.qty}))})
    });
    const data = await res.json();
    if(data.checkoutId){
      window.LemonSqueezy.openCheckout(data.checkoutId);
    } else {
      alert("Failed to start checkout");
    }
  } catch(e){
    console.error(e);
    alert("Checkout failed");
  }
}

/* -------------- NAV -------------- */
function showPage(page){
  ["productsSection","aboutSection","contactSection"].forEach(id=>document.getElementById(id).style.display="none");
  ["nav-products","nav-about","nav-contact"].forEach(id=>document.getElementById(id).classList.remove("active"));
  if(page==="products"){document.getElementById("productsSection").style.display=""; document.getElementById("nav-products").classList.add("active");}
  else if(page==="about"){document.getElementById("aboutSection").style.display=""; document.getElementById("nav-about").classList.add("active");}
  else if(page==="contact"){document.getElementById("contactSection").style.display=""; document.getElementById("nav-contact").classList.add("active");}
}

/* -------------- INIT -------------- */
document.getElementById('cartButton').addEventListener('click', openCart);
window.addEventListener('DOMContentLoaded', ()=>{
  renderProducts();
  renderCart();
  showPage('products');
});
</script>
</body>
</html>
